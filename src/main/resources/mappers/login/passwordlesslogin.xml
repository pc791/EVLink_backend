<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.evlink.domain.login.dao.PasswordLessLoginDao">
    <!-- Login Check -->
    <select id="checkPassword" parameterType="plUserInfo" resultType="plUserInfo">
        SELECT id, pw, email, regdate
        FROM userinfo
        WHERE id = #{id} AND pw = sha(#{pw})
    </select>

    <!-- Search for User Information -->
    <select id="getUserInfo" parameterType="plUserInfo" resultType="plUserInfo">
        SELECT id, pw, email, regdate
        FROM userinfo
        WHERE id = #{id}
    </select>
    
    <!-- Password Update -->
    <update id="updatePassword">
        UPDATE userinfo
        SET pw=sha(#{pw})
        WHERE id = #{id}
    </update>
    
    <!-- User Registration -->
    <insert id="createUserInfo">
        INSERT INTO userinfo (id, pw, email)
        VALUES(#{id}, sha(#{pw}), #{email})
    </insert>
    
    <!-- User Deletion -->
    <delete id="withdrawUserInfo">
        DELETE FROM userinfo
        WHERE id = #{id}
    </delete>

    <!-- Password Change -->
    <update id="changepw">
        UPDATE userinfo
        SET pw = sha(#{pw})
        WHERE id = #{id}
    </update>
    
</mapper>